<body>
  <h3 id="demo" style="position: fixed; top: 0; right: 0; color: white; border-radius:20px; border: 2px solid #343A40; background: #007BFF; margin-right: 0px"></h3> 
  <div >
  <%= form_with(model: @question, url: exam_student_answers_path, local: false, html: { id: "exam_question" }) do |f| %>
    <table class="table">
      <thead class="thead-dark">
        <tr>
          <th>No.</th>
          <th style="width:95%;">Question</th>
          <th></th>
        </tr> 
      </thead>
      <% count = 1 %>
      <% @questions.each do |question| %>
        <tr>
          <td><%= count %></td>
          <td><%= question.info %></td>
          <td align="right">[1]</td>
        </tr>
        <tr>
          <td></td>
          <td>
            <% question.options.each do |option| %>
              <%= f.radio_button question.id, option.id, :checked => false %>
              (<%= option.option_index %>.)
              <%= option.name %>
              <br />
            <% end %>
          </td>
        </tr>
        <br/>
        <% count += 1 %>
      <% end %>
    </table>
    <%= f.submit "Submit Exam", :class => "btn btn-primary btn-xs" %> 
  <% end %>
  </div>

  <script> 
    dd = "<%= @exam.end_date.strftime("%b %d, %Y %H:%M:%S") %>"
    var deadline = new Date(dd).getTime(); 
    var x = setInterval(function() { 
      var now = new Date().getTime(); 
      var t = deadline - now; 
      var days = Math.floor(t / (1000 * 60 * 60 * 24)); 
      var hours = Math.floor((t%(1000 * 60 * 60 * 24))/(1000 * 60 * 60)); 
      var minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60)); 
      var seconds = Math.floor((t % (1000 * 60)) / 1000); 
      document.getElementById("demo").innerHTML ="Time remaining: " + hours + "h " + minutes + "m " + seconds + "s "; 
          if (t < 0) { 
              clearInterval(x); 
              document.getElementById("demo").innerHTML = "EXPIRED"; 
              document.getElementById("exam_question").submit();
                } 
              }, 1000);
      function submitform(){
        // clearInterval(x);
        document.getElementById("exam_question").submit();
      }
      history.pushState(null, document.title, location.href);
      history.pushState(null, document.title, location.href);
      window.addEventListener('popstate', function (event)
      {
        history.pushState(null, document.title, location.href);
        history.pushState(null, document.title, location.href);
      });
      window.onbeforeunload = function () {
        return "selected answer will be lost";
      }

  </script>
</body>
